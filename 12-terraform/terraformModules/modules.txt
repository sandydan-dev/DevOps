# Terraform Modules

# what is Terraform modules ?
- a module is reusable, self-content, terraform package (one or more .tf files) that encapsulates resource, variables, 
  outputs, so we can reuse the same info logic acros project.  

✅ Folder layout (recommended)  

project/
├─ main.tf                # root module (calls child modules)
├─ variables.tf
├─ outputs.tf
└─ modules/
   └─ ec2/
      ├─ main.tf
      ├─ variables.tf
      ├─ outputs.tf
      └─ README.md


✅ Create a simple reusable EC2 module

> modules/ec2/variable.tf 

// tag name 
variable "name" {
    type = string
    default = "example"
}

// ami 
variable "ami" {
    type = string
    description = "AMI id"
}

// instance type 
variable "instance_type" {
    type = string 
    default = "t2.micro"
}

// security group id 
variable ""vpc_security_group_ids" {
    type = list(string)
    default = []
}


> modules/ec2/main.tf 

// ec2 resource 

resource "aws_instance" "this" {
    ami = "ami-id"
    instance_type = var.instance_type
    vpc_security_group_ids = vpc_security_group_ids

    tags = {
        Name = var.name 
    }
}


> modules/ec2/outputs.tf

output "id" {
    value = aws_instance.this.id 
}

output "public_ip" {
    value = aws_instance.this.public_ip
}


✅ consume the modules (root module)

> project/main.tf  (root)

provider "aws" {
    region = "us-east-1"
}

module "web" {
    source = "./modules/ec2"
    
    name = "web-serve"
    ami  = "ami-2kj34kj234l234j"
    instance_type = "t2.small   // override
    vpc_security_group_ids = [aws_security_group_ids]
}


> project/outputs.tf 

output "web_ip" {
    value = "module.web.public_ip"
}


✅ then run that root "main.tf" file 
cmd: terraform plan 

cmd: terraform apply -auto-approve